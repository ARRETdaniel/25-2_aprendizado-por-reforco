
======================================================================
TD3 TRAINING PIPELINE - AUTONOMOUS VEHICLE NAVIGATION
======================================================================

[CONFIG] Loading configurations...
[CONFIG] CARLA config: config/carla_config.yaml
[CONFIG] Agent config: config/td3_config.yaml
[CONFIG] Scenario: 0 (0=20, 1=50, 2=100 NPCs)
[CONFIG] NPC count set to: 20

[ENVIRONMENT] Initializing CARLA environment...
[ENVIRONMENT] State space: Dict('image': Box(0.0, 1.0, (4, 84, 84), float32), 'vector': Box(-inf, inf, (23,), float32))
[ENVIRONMENT] Action space: Box(-1.0, 1.0, (2,), float32)

[AGENT] Initializing TD3 agent...
[AGENT] Using device: cpu
TD3Agent initialized on device: cpu (manually specified)
TD3Agent initialized with:
  State dim: 535, Action dim: 2
  Actor hidden size: [256, 256]
  Critic hidden size: [256, 256]
  Discount Œ≥: 0.99, Tau œÑ: 0.005
  Policy freq: 2, Policy noise: 0.2
  Exploration noise: 0.1
  Buffer size: 1000000, Batch size: 256
[LOGGING] TensorBoard logs: data/logs/TD3_scenario_0_npcs_20_20251022-230528

[DEBUG] Visual feedback enabled (OpenCV display)
[DEBUG] Press 'q' to quit, 'p' to pause/unpause

[INIT] Training pipeline ready!
[INIT] Max timesteps: 100
[INIT] Seed: 42
======================================================================

[TRAINING] Starting training loop...
No scenarios found in config, using default NPC count: 50
üîç [DEBUG Step   10] Act=[steer:-0.298, thr/brk:+0.009] | Rew=  +0.72 | Speed= 19.4 km/h | LatDev=-0.00m | Collisions=0
üîç [DEBUG Step   20] Act=[steer:+0.032, thr/brk:+0.062] | Rew=  +1.78 | Speed= 37.0 km/h | LatDev=-0.00m | Collisions=0
Collision detected with vehicle.nissan.patrol_2021 (impulse: 5391.67724609375)
[TRAIN] Episode    0 | Timestep      24 | Reward 100023.40 | Avg Reward (10ep) 100023.40 | Collisions  0
No scenarios found in config, using default NPC count: 50
üîç [DEBUG Step   30] Act=[steer:+0.630, thr/brk:-0.323] | Rew=  +0.62 | Speed= 12.3 km/h | LatDev=-0.00m | Collisions=0
üîç [DEBUG Step   40] Act=[steer:-0.892, thr/brk:+0.612] | Rew=  +1.43 | Speed= 30.0 km/h | LatDev=-0.00m | Collisions=0
üîç [DEBUG Step   50] Act=[steer:-0.140, thr/brk:+0.782] | Rew=  -0.17 | Speed=  2.2 km/h | LatDev=-0.00m | Collisions=0
üîç [DEBUG Step   60] Act=[steer:+0.939, thr/brk:-0.766] | Rew=  +0.44 | Speed=  0.1 km/h | LatDev=-0.00m | Collisions=0
üîç [DEBUG Step   70] Act=[steer:-0.101, thr/brk:-0.633] | Rew=  +0.44 | Speed=  0.0 km/h | LatDev=-0.00m | Collisions=0
üîç [DEBUG Step   80] Act=[steer:+0.744, thr/brk:+0.936] | Rew=  +0.45 | Speed=  0.3 km/h | LatDev=-0.00m | Collisions=0
üîç [DEBUG Step   90] Act=[steer:+0.980, thr/brk:+0.168] | Rew=  +0.36 | Speed=  0.3 km/h | LatDev=+0.00m | Collisions=0
üîç [DEBUG Step  100] Act=[steer:-0.015, thr/brk:-0.876] | Rew=  +0.45 | Speed=  0.0 km/h | LatDev=+0.00m | Collisions=0

[EVAL] Evaluation at timestep 100...
Traceback (most recent call last):
  File "/workspace/av_td3_system/scripts/train_td3.py", line 706, in <module>
    main()
  File "/workspace/av_td3_system/scripts/train_td3.py", line 702, in main
    trainer.train()
  File "/workspace/av_td3_system/scripts/train_td3.py", line 494, in train
    eval_metrics = self.evaluate()
  File "/workspace/av_td3_system/scripts/train_td3.py", line 540, in evaluate
    obs_dict = self.eval_env.reset()
AttributeError: 'TD3TrainingPipeline' object has no attribute 'eval_env'
