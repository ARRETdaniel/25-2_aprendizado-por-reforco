WARNING:root:Could not import GlobalRoutePlanner from agents.navigation. Ensure CARLA Python API is installed and PythonAPI/carla/agents is in PYTHONPATH.

======================================================================
TD3 TRAINING PIPELINE - AUTONOMOUS VEHICLE NAVIGATION
======================================================================

[CONFIG] Loading configurations...
[CONFIG] CARLA config: config/carla_config.yaml
[CONFIG] Agent config: config/td3_config.yaml
[CONFIG] Scenario: 0 (0=20, 1=50, 2=100 NPCs)
[CONFIG] NPC count set to: 20

[ENVIRONMENT] Initializing CARLA environment...
WARNING:src.environment.carla_env:Failed to initialize DynamicRouteManager: GlobalRoutePlanner not available. Ensure CARLA agents package is installed.
Falling back to legacy waypoint manager
[ENVIRONMENT] State space: Dict('image': Box(0.0, 1.0, (4, 84, 84), float32), 'vector': Box(-inf, inf, (23,), float32))
[ENVIRONMENT] Action space: Box(-1.0, 1.0, (2,), float32)

[AGENT] Initializing TD3 agent...
[AGENT] Device explicitly set to: cpu
[AGENT] Running on CPU to reserve GPU memory for CARLA simulator
TD3Agent initialized on device: cpu (manually specified)
TD3Agent initialized with:
  State dim: 535, Action dim: 2
  Actor hidden size: [256, 256]
  Critic hidden size: [256, 256]
  Discount γ: 0.99, Tau τ: 0.005
  Policy freq: 2, Policy noise: 0.2
  Exploration noise: 0.1
  Buffer size: 1000000, Batch size: 256
[AGENT] Initializing NatureCNN feature extractor...
[AGENT] CNN extractor initialized on cpu
[AGENT] CNN architecture: 4×84×84 → Conv layers → 512 features
[LOGGING] TensorBoard logs: data/logs/TD3_scenario_0_npcs_20_20251026-013222

[INIT] Training pipeline ready!
[INIT] Max timesteps: 30,000
[INIT] Seed: 42
======================================================================

[TRAINING] Starting training loop...
[TRAINING] Initializing CARLA environment (spawning actors)...
[TRAINING] This may take 1-5 minutes on first reset. Please be patient...
[TRAINING] Connecting to CARLA server...
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
[TRAINING] Environment initialized successfully in 4.3 seconds!
[TRAINING] Actors spawned, sensors ready
[TRAINING] Beginning training from timestep 1 to 30,000

[TRAINING PHASES]
  Phase 1 (Steps 1-10,000): EXPLORATION (random actions, filling replay buffer)
  Phase 2 (Steps 10,001-30,000): LEARNING (policy updates)
  Evaluation every 5,000 steps
  Checkpoints every 10,000 steps

[PROGRESS] Training starting now - logging every 100 steps...

[EXPLORATION] Processing step    100/30,000...
[EXPLORATION] Step    100/30,000 | Episode    0 | Ep Step  100 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=    100/1000000
[EXPLORATION] Processing step    200/30,000...
[EXPLORATION] Step    200/30,000 | Episode    0 | Ep Step  200 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=    200/1000000
[EXPLORATION] Processing step    300/30,000...
[EXPLORATION] Step    300/30,000 | Episode    0 | Ep Step  300 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=    300/1000000
[EXPLORATION] Processing step    400/30,000...
[EXPLORATION] Step    400/30,000 | Episode    0 | Ep Step  400 | Reward=  -1.00 | Speed=  0.1 km/h | Buffer=    400/1000000
[EXPLORATION] Processing step    500/30,000...
[EXPLORATION] Step    500/30,000 | Episode    0 | Ep Step  500 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=    500/1000000
[EXPLORATION] Processing step    600/30,000...
[EXPLORATION] Step    600/30,000 | Episode    0 | Ep Step  600 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=    600/1000000
[EXPLORATION] Processing step    700/30,000...
[EXPLORATION] Step    700/30,000 | Episode    0 | Ep Step  700 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=    700/1000000
[EXPLORATION] Processing step    800/30,000...
[EXPLORATION] Step    800/30,000 | Episode    0 | Ep Step  800 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=    800/1000000
[EXPLORATION] Processing step    900/30,000...
[EXPLORATION] Step    900/30,000 | Episode    0 | Ep Step  900 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=    900/1000000
[EXPLORATION] Processing step   1000/30,000...
[EXPLORATION] Step   1000/30,000 | Episode    0 | Ep Step 1000 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   1000/1000000
[EXPLORATION] Processing step   1100/30,000...
[EXPLORATION] Step   1100/30,000 | Episode    0 | Ep Step 1100 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   1100/1000000
[EXPLORATION] Processing step   1200/30,000...
[EXPLORATION] Step   1200/30,000 | Episode    0 | Ep Step 1200 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   1200/1000000
[EXPLORATION] Processing step   1300/30,000...
[EXPLORATION] Step   1300/30,000 | Episode    0 | Ep Step 1300 | Reward=  -1.00 | Speed=  0.4 km/h | Buffer=   1300/1000000
[EXPLORATION] Processing step   1400/30,000...
[EXPLORATION] Step   1400/30,000 | Episode    0 | Ep Step 1400 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   1400/1000000
[EXPLORATION] Processing step   1500/30,000...
[EXPLORATION] Step   1500/30,000 | Episode    0 | Ep Step 1500 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   1500/1000000
[EXPLORATION] Processing step   1600/30,000...
[EXPLORATION] Step   1600/30,000 | Episode    0 | Ep Step 1600 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   1600/1000000
[EXPLORATION] Processing step   1700/30,000...
[EXPLORATION] Step   1700/30,000 | Episode    0 | Ep Step 1700 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   1700/1000000
[EXPLORATION] Processing step   1800/30,000...
[EXPLORATION] Step   1800/30,000 | Episode    0 | Ep Step 1800 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   1800/1000000
[EXPLORATION] Processing step   1900/30,000...
[EXPLORATION] Step   1900/30,000 | Episode    0 | Ep Step 1900 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   1900/1000000
[EXPLORATION] Processing step   2000/30,000...
[EXPLORATION] Step   2000/30,000 | Episode    0 | Ep Step 2000 | Reward=  -1.00 | Speed=  0.2 km/h | Buffer=   2000/1000000
[EXPLORATION] Processing step   2100/30,000...
[EXPLORATION] Step   2100/30,000 | Episode    0 | Ep Step 2100 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   2100/1000000
[EXPLORATION] Processing step   2200/30,000...
[EXPLORATION] Step   2200/30,000 | Episode    0 | Ep Step 2200 | Reward=  -0.99 | Speed=  1.0 km/h | Buffer=   2200/1000000
[EXPLORATION] Processing step   2300/30,000...
[EXPLORATION] Step   2300/30,000 | Episode    0 | Ep Step 2300 | Reward=  -1.00 | Speed=  0.4 km/h | Buffer=   2300/1000000
[EXPLORATION] Processing step   2400/30,000...
[EXPLORATION] Step   2400/30,000 | Episode    0 | Ep Step 2400 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   2400/1000000
[EXPLORATION] Processing step   2500/30,000...
[EXPLORATION] Step   2500/30,000 | Episode    0 | Ep Step 2500 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   2500/1000000
[EXPLORATION] Processing step   2600/30,000...
[EXPLORATION] Step   2600/30,000 | Episode    0 | Ep Step 2600 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   2600/1000000
[EXPLORATION] Processing step   2700/30,000...
[EXPLORATION] Step   2700/30,000 | Episode    0 | Ep Step 2700 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   2700/1000000
[EXPLORATION] Processing step   2800/30,000...
[EXPLORATION] Step   2800/30,000 | Episode    0 | Ep Step 2800 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   2800/1000000
[EXPLORATION] Processing step   2900/30,000...
[EXPLORATION] Step   2900/30,000 | Episode    0 | Ep Step 2900 | Reward=  -1.00 | Speed=  0.5 km/h | Buffer=   2900/1000000
[EXPLORATION] Processing step   3000/30,000...
[EXPLORATION] Step   3000/30,000 | Episode    0 | Ep Step 3000 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   3000/1000000
[EXPLORATION] Processing step   3100/30,000...
[EXPLORATION] Step   3100/30,000 | Episode    0 | Ep Step 3100 | Reward=  -1.00 | Speed=  0.2 km/h | Buffer=   3100/1000000
[EXPLORATION] Processing step   3200/30,000...
[EXPLORATION] Step   3200/30,000 | Episode    0 | Ep Step 3200 | Reward=  -1.00 | Speed=  0.7 km/h | Buffer=   3200/1000000
[EXPLORATION] Processing step   3300/30,000...
[EXPLORATION] Step   3300/30,000 | Episode    0 | Ep Step 3300 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   3300/1000000
[EXPLORATION] Processing step   3400/30,000...
[EXPLORATION] Step   3400/30,000 | Episode    0 | Ep Step 3400 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   3400/1000000
[EXPLORATION] Processing step   3500/30,000...
[EXPLORATION] Step   3500/30,000 | Episode    0 | Ep Step 3500 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   3500/1000000
[EXPLORATION] Processing step   3600/30,000...
[EXPLORATION] Step   3600/30,000 | Episode    0 | Ep Step 3600 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   3600/1000000
[EXPLORATION] Processing step   3700/30,000...
[EXPLORATION] Step   3700/30,000 | Episode    0 | Ep Step 3700 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   3700/1000000
[EXPLORATION] Processing step   3800/30,000...
[EXPLORATION] Step   3800/30,000 | Episode    0 | Ep Step 3800 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   3800/1000000
[EXPLORATION] Processing step   3900/30,000...
[EXPLORATION] Step   3900/30,000 | Episode    0 | Ep Step 3900 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   3900/1000000
[EXPLORATION] Processing step   4000/30,000...
[EXPLORATION] Step   4000/30,000 | Episode    0 | Ep Step 4000 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   4000/1000000
[EXPLORATION] Processing step   4100/30,000...
[EXPLORATION] Step   4100/30,000 | Episode    0 | Ep Step 4100 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   4100/1000000
[EXPLORATION] Processing step   4200/30,000...
[EXPLORATION] Step   4200/30,000 | Episode    0 | Ep Step 4200 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   4200/1000000
[EXPLORATION] Processing step   4300/30,000...
[EXPLORATION] Step   4300/30,000 | Episode    0 | Ep Step 4300 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   4300/1000000
[EXPLORATION] Processing step   4400/30,000...
[EXPLORATION] Step   4400/30,000 | Episode    0 | Ep Step 4400 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   4400/1000000
[EXPLORATION] Processing step   4500/30,000...
[EXPLORATION] Step   4500/30,000 | Episode    0 | Ep Step 4500 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   4500/1000000
[EXPLORATION] Processing step   4600/30,000...
[EXPLORATION] Step   4600/30,000 | Episode    0 | Ep Step 4600 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   4600/1000000
[EXPLORATION] Processing step   4700/30,000...
[EXPLORATION] Step   4700/30,000 | Episode    0 | Ep Step 4700 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   4700/1000000
[EXPLORATION] Processing step   4800/30,000...
[EXPLORATION] Step   4800/30,000 | Episode    0 | Ep Step 4800 | Reward=  -1.00 | Speed=  0.6 km/h | Buffer=   4800/1000000
[EXPLORATION] Processing step   4900/30,000...
[EXPLORATION] Step   4900/30,000 | Episode    0 | Ep Step 4900 | Reward=  -1.00 | Speed=  0.6 km/h | Buffer=   4900/1000000
[EXPLORATION] Processing step   5000/30,000...
[EXPLORATION] Step   5000/30,000 | Episode    0 | Ep Step 5000 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   5000/1000000

[EVAL] Evaluation at timestep 5,000...
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff7742b7e60>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff7743604a0>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff7743603c0>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774360660>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774360970>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774360c80>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774360f90>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff7743612a0>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff7743615b0>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774360200>]
[EVAL] Mean Reward: -463.09 | Success Rate: 0.0% | Avg Collisions: 0.00 | Avg Length: 88

[TRAIN] Episode    0 | Timestep    5001 | Reward -5285.74 | Avg Reward (10ep) -5285.74 | Collisions  0
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
[EXPLORATION] Processing step   5100/30,000...
[EXPLORATION] Step   5100/30,000 | Episode    1 | Ep Step   99 | Reward=  -1.00 | Speed=  0.7 km/h | Buffer=   5100/1000000
[EXPLORATION] Processing step   5200/30,000...
[EXPLORATION] Step   5200/30,000 | Episode    1 | Ep Step  199 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   5200/1000000
[EXPLORATION] Processing step   5300/30,000...
[EXPLORATION] Step   5300/30,000 | Episode    1 | Ep Step  299 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   5300/1000000
[EXPLORATION] Processing step   5400/30,000...
[EXPLORATION] Step   5400/30,000 | Episode    1 | Ep Step  399 | Reward=  -1.00 | Speed=  0.4 km/h | Buffer=   5400/1000000
[EXPLORATION] Processing step   5500/30,000...
[EXPLORATION] Step   5500/30,000 | Episode    1 | Ep Step  499 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   5500/1000000
[EXPLORATION] Processing step   5600/30,000...
[EXPLORATION] Step   5600/30,000 | Episode    1 | Ep Step  599 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   5600/1000000
[EXPLORATION] Processing step   5700/30,000...
[EXPLORATION] Step   5700/30,000 | Episode    1 | Ep Step  699 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   5700/1000000
[EXPLORATION] Processing step   5800/30,000...
[EXPLORATION] Step   5800/30,000 | Episode    1 | Ep Step  799 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   5800/1000000
[EXPLORATION] Processing step   5900/30,000...
[EXPLORATION] Step   5900/30,000 | Episode    1 | Ep Step  899 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   5900/1000000
[EXPLORATION] Processing step   6000/30,000...
[EXPLORATION] Step   6000/30,000 | Episode    1 | Ep Step  999 | Reward=  -1.00 | Speed=  0.2 km/h | Buffer=   6000/1000000
[EXPLORATION] Processing step   6100/30,000...
[EXPLORATION] Step   6100/30,000 | Episode    1 | Ep Step 1099 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   6100/1000000
[EXPLORATION] Processing step   6200/30,000...
[EXPLORATION] Step   6200/30,000 | Episode    1 | Ep Step 1199 | Reward=  -1.00 | Speed=  0.2 km/h | Buffer=   6200/1000000
[EXPLORATION] Processing step   6300/30,000...
[EXPLORATION] Step   6300/30,000 | Episode    1 | Ep Step 1299 | Reward=  -0.99 | Speed=  1.6 km/h | Buffer=   6300/1000000
[EXPLORATION] Processing step   6400/30,000...
[EXPLORATION] Step   6400/30,000 | Episode    1 | Ep Step 1399 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   6400/1000000
[EXPLORATION] Processing step   6500/30,000...
[EXPLORATION] Step   6500/30,000 | Episode    1 | Ep Step 1499 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   6500/1000000
[EXPLORATION] Processing step   6600/30,000...
[EXPLORATION] Step   6600/30,000 | Episode    1 | Ep Step 1599 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   6600/1000000
[EXPLORATION] Processing step   6700/30,000...
[EXPLORATION] Step   6700/30,000 | Episode    1 | Ep Step 1699 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   6700/1000000
[EXPLORATION] Processing step   6800/30,000...
[EXPLORATION] Step   6800/30,000 | Episode    1 | Ep Step 1799 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   6800/1000000
[EXPLORATION] Processing step   6900/30,000...
[EXPLORATION] Step   6900/30,000 | Episode    1 | Ep Step 1899 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   6900/1000000
[EXPLORATION] Processing step   7000/30,000...
[EXPLORATION] Step   7000/30,000 | Episode    1 | Ep Step 1999 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   7000/1000000
[EXPLORATION] Processing step   7100/30,000...
[EXPLORATION] Step   7100/30,000 | Episode    1 | Ep Step 2099 | Reward=  -1.00 | Speed=  0.4 km/h | Buffer=   7100/1000000
[EXPLORATION] Processing step   7200/30,000...
[EXPLORATION] Step   7200/30,000 | Episode    1 | Ep Step 2199 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   7200/1000000
[EXPLORATION] Processing step   7300/30,000...
[EXPLORATION] Step   7300/30,000 | Episode    1 | Ep Step 2299 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   7300/1000000
[EXPLORATION] Processing step   7400/30,000...
[EXPLORATION] Step   7400/30,000 | Episode    1 | Ep Step 2399 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   7400/1000000
[EXPLORATION] Processing step   7500/30,000...
[EXPLORATION] Step   7500/30,000 | Episode    1 | Ep Step 2499 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   7500/1000000
[EXPLORATION] Processing step   7600/30,000...
[EXPLORATION] Step   7600/30,000 | Episode    1 | Ep Step 2599 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   7600/1000000
[EXPLORATION] Processing step   7700/30,000...
[EXPLORATION] Step   7700/30,000 | Episode    1 | Ep Step 2699 | Reward=  -0.99 | Speed=  1.3 km/h | Buffer=   7700/1000000
[EXPLORATION] Processing step   7800/30,000...
[EXPLORATION] Step   7800/30,000 | Episode    1 | Ep Step 2799 | Reward=  -1.00 | Speed=  0.1 km/h | Buffer=   7800/1000000
[EXPLORATION] Processing step   7900/30,000...
[EXPLORATION] Step   7900/30,000 | Episode    1 | Ep Step 2899 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   7900/1000000
[EXPLORATION] Processing step   8000/30,000...
[EXPLORATION] Step   8000/30,000 | Episode    1 | Ep Step 2999 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   8000/1000000
[EXPLORATION] Processing step   8100/30,000...
[EXPLORATION] Step   8100/30,000 | Episode    1 | Ep Step 3099 | Reward=  -1.00 | Speed=  0.1 km/h | Buffer=   8100/1000000
[EXPLORATION] Processing step   8200/30,000...
[EXPLORATION] Step   8200/30,000 | Episode    1 | Ep Step 3199 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   8200/1000000
[EXPLORATION] Processing step   8300/30,000...
[EXPLORATION] Step   8300/30,000 | Episode    1 | Ep Step 3299 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   8300/1000000
[EXPLORATION] Processing step   8400/30,000...
[EXPLORATION] Step   8400/30,000 | Episode    1 | Ep Step 3399 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   8400/1000000
[EXPLORATION] Processing step   8500/30,000...
[EXPLORATION] Step   8500/30,000 | Episode    1 | Ep Step 3499 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   8500/1000000
[EXPLORATION] Processing step   8600/30,000...
[EXPLORATION] Step   8600/30,000 | Episode    1 | Ep Step 3599 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   8600/1000000
[EXPLORATION] Processing step   8700/30,000...
[EXPLORATION] Step   8700/30,000 | Episode    1 | Ep Step 3699 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   8700/1000000
[EXPLORATION] Processing step   8800/30,000...
[EXPLORATION] Step   8800/30,000 | Episode    1 | Ep Step 3799 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   8800/1000000
[EXPLORATION] Processing step   8900/30,000...
[EXPLORATION] Step   8900/30,000 | Episode    1 | Ep Step 3899 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   8900/1000000
[EXPLORATION] Processing step   9000/30,000...
[EXPLORATION] Step   9000/30,000 | Episode    1 | Ep Step 3999 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   9000/1000000
[EXPLORATION] Processing step   9100/30,000...
[EXPLORATION] Step   9100/30,000 | Episode    1 | Ep Step 4099 | Reward=  -0.99 | Speed=  0.9 km/h | Buffer=   9100/1000000
[EXPLORATION] Processing step   9200/30,000...
[EXPLORATION] Step   9200/30,000 | Episode    1 | Ep Step 4199 | Reward=  -1.00 | Speed=  0.4 km/h | Buffer=   9200/1000000
[EXPLORATION] Processing step   9300/30,000...
[EXPLORATION] Step   9300/30,000 | Episode    1 | Ep Step 4299 | Reward=  -1.00 | Speed=  0.1 km/h | Buffer=   9300/1000000
[EXPLORATION] Processing step   9400/30,000...
[EXPLORATION] Step   9400/30,000 | Episode    1 | Ep Step 4399 | Reward=  -1.00 | Speed=  0.3 km/h | Buffer=   9400/1000000
[EXPLORATION] Processing step   9500/30,000...
[EXPLORATION] Step   9500/30,000 | Episode    1 | Ep Step 4499 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   9500/1000000
[EXPLORATION] Processing step   9600/30,000...
[EXPLORATION] Step   9600/30,000 | Episode    1 | Ep Step 4599 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   9600/1000000
[EXPLORATION] Processing step   9700/30,000...
[EXPLORATION] Step   9700/30,000 | Episode    1 | Ep Step 4699 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   9700/1000000
[EXPLORATION] Processing step   9800/30,000...
[EXPLORATION] Step   9800/30,000 | Episode    1 | Ep Step 4799 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   9800/1000000
[EXPLORATION] Processing step   9900/30,000...
[EXPLORATION] Step   9900/30,000 | Episode    1 | Ep Step 4899 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=   9900/1000000
[EXPLORATION] Processing step  10000/30,000...
[EXPLORATION] Step  10000/30,000 | Episode    1 | Ep Step 4999 | Reward=  -1.00 | Speed=  0.6 km/h | Buffer=  10000/1000000

[EVAL] Evaluation at timestep 10,000...
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774360890>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774361b60>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774361e70>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff7743611c0>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774360cf0>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774361850>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff7743602e0>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774362500>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774361d20>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774360820>]
[EVAL] Mean Reward: -463.47 | Success Rate: 0.0% | Avg Collisions: 0.00 | Avg Length: 88

Checkpoint saved to data/checkpoints/td3_scenario_0_step_10000.pth
[CHECKPOINT] Saved to data/checkpoints/td3_scenario_0_step_10000.pth

======================================================================
[PHASE TRANSITION] Starting LEARNING phase at step 10,001
[PHASE TRANSITION] Replay buffer size: 10,001
[PHASE TRANSITION] Policy updates will now begin...
======================================================================

WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
[LEARNING] Processing step  10100/30,000...
[LEARNING] Step  10100/30,000 | Episode    2 | Ep Step   99 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  10100/1000000
[LEARNING] Processing step  10200/30,000...
[LEARNING] Step  10200/30,000 | Episode    2 | Ep Step  199 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  10200/1000000
[LEARNING] Processing step  10300/30,000...
[LEARNING] Step  10300/30,000 | Episode    2 | Ep Step  299 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  10300/1000000
[LEARNING] Processing step  10400/30,000...
[LEARNING] Step  10400/30,000 | Episode    2 | Ep Step  399 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  10400/1000000
[LEARNING] Processing step  10500/30,000...
[LEARNING] Step  10500/30,000 | Episode    2 | Ep Step  499 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  10500/1000000
[LEARNING] Processing step  10600/30,000...
[LEARNING] Step  10600/30,000 | Episode    2 | Ep Step  599 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  10600/1000000
[LEARNING] Processing step  10700/30,000...
[LEARNING] Step  10700/30,000 | Episode    2 | Ep Step  699 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  10700/1000000
[LEARNING] Processing step  10800/30,000...
[LEARNING] Step  10800/30,000 | Episode    2 | Ep Step  799 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  10800/1000000
[LEARNING] Processing step  10900/30,000...
[LEARNING] Step  10900/30,000 | Episode    2 | Ep Step  899 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  10900/1000000
[LEARNING] Processing step  11000/30,000...
[LEARNING] Step  11000/30,000 | Episode    2 | Ep Step  999 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  11000/1000000
[LEARNING] Processing step  11100/30,000...
[LEARNING] Step  11100/30,000 | Episode    2 | Ep Step 1099 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  11100/1000000
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774362880>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
[LEARNING] Processing step  11200/30,000...
[LEARNING] Step  11200/30,000 | Episode    3 | Ep Step   13 | Reward=  -0.35 | Speed=  8.8 km/h | Buffer=  11200/1000000
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff7743629d0>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774362b20>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff7743621f0>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff7743625e0>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774361a80>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774363060>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
[LEARNING] Processing step  11300/30,000...
[LEARNING] Step  11300/30,000 | Episode    9 | Ep Step   15 | Reward=  -0.51 | Speed= 11.3 km/h | Buffer=  11300/1000000
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff7743631b0>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774360580>]
[TRAIN] Episode   10 | Timestep   11317 | Reward  -453.82 | Avg Reward (10ep) -1059.68 | Collisions  0
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774362110>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774362e30>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774363990>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774363680>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774363f40>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
[LEARNING] Processing step  11400/30,000...
[LEARNING] Step  11400/30,000 | Episode   16 | Ep Step    2 | Reward=  +0.72 | Speed=  5.3 km/h | Buffer=  11400/1000000
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774362960>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774363a00>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Collision detected with vehicle.audi.tt (impulse: 54.09504699707031)
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff7743634c0>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774362f80>]
[TRAIN] Episode   20 | Timestep   11470 | Reward  -455.20 | Avg Reward (10ep)  -504.16 | Collisions  0
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff7743620a0>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
[LEARNING] Processing step  11500/30,000...
[LEARNING] Step  11500/30,000 | Episode   22 | Ep Step   14 | Reward=  -0.42 | Speed=  9.7 km/h | Buffer=  11500/1000000
WARNING:src.environment.sensors:Lane invasion detected: [<carla.libcarla.LaneMarking object at 0x7ff774363610>]
WARNING:src.environment.carla_env:No scenarios found in config, using default NPC count: 50
[LEARNING] Processing step  11600/30,000...
[LEARNING] Step  11600/30,000 | Episode   23 | Ep Step   98 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  11600/1000000
[LEARNING] Processing step  11700/30,000...
[LEARNING] Step  11700/30,000 | Episode   23 | Ep Step  198 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  11700/1000000
[LEARNING] Processing step  11800/30,000...
[LEARNING] Step  11800/30,000 | Episode   23 | Ep Step  298 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  11800/1000000
[LEARNING] Processing step  11900/30,000...
[LEARNING] Step  11900/30,000 | Episode   23 | Ep Step  398 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  11900/1000000
[LEARNING] Processing step  12000/30,000...
[LEARNING] Step  12000/30,000 | Episode   23 | Ep Step  498 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  12000/1000000
[LEARNING] Processing step  12100/30,000...
[LEARNING] Step  12100/30,000 | Episode   23 | Ep Step  598 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  12100/1000000
[LEARNING] Processing step  12200/30,000...
[LEARNING] Step  12200/30,000 | Episode   23 | Ep Step  698 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  12200/1000000
[LEARNING] Processing step  12300/30,000...
[LEARNING] Step  12300/30,000 | Episode   23 | Ep Step  798 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  12300/1000000
[LEARNING] Processing step  12400/30,000...
[LEARNING] Step  12400/30,000 | Episode   23 | Ep Step  898 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  12400/1000000
[LEARNING] Processing step  12500/30,000...
[LEARNING] Step  12500/30,000 | Episode   23 | Ep Step  998 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  12500/1000000
[LEARNING] Processing step  12600/30,000...
[LEARNING] Step  12600/30,000 | Episode   23 | Ep Step 1098 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  12600/1000000
[LEARNING] Processing step  12700/30,000...
[LEARNING] Step  12700/30,000 | Episode   23 | Ep Step 1198 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  12700/1000000
[LEARNING] Processing step  12800/30,000...
[LEARNING] Step  12800/30,000 | Episode   23 | Ep Step 1298 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  12800/1000000
[LEARNING] Processing step  12900/30,000...
[LEARNING] Step  12900/30,000 | Episode   23 | Ep Step 1398 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  12900/1000000
[LEARNING] Processing step  13000/30,000...
[LEARNING] Step  13000/30,000 | Episode   23 | Ep Step 1498 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  13000/1000000
[LEARNING] Processing step  13100/30,000...
[LEARNING] Step  13100/30,000 | Episode   23 | Ep Step 1598 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  13100/1000000
[LEARNING] Processing step  13200/30,000...
[LEARNING] Step  13200/30,000 | Episode   23 | Ep Step 1698 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  13200/1000000
[LEARNING] Processing step  13300/30,000...
[LEARNING] Step  13300/30,000 | Episode   23 | Ep Step 1798 | Reward=  -1.00 | Speed=  0.0 km/h | Buffer=  13300/1000000
