# Configuration file for PID + Pure Pursuit Baseline Controller
# Based on parameters from FinalProject/controller2d.py

# Baseline controller configuration
baseline_controller:
  # PID Controller parameters (longitudinal/speed control)
  pid:
    # Proportional gain - how aggressively to respond to current error
    kp: 0.50

    # Integral gain - how aggressively to respond to accumulated error
    # Helps eliminate steady-state error
    ki: 0.30

    # Derivative gain - how aggressively to respond to rate of change of error
    # Provides damping and reduces oscillations
    kd: 0.13

    # Anti-windup integrator bounds
    # Prevents integral term from growing unbounded during saturation
    integrator_min: 0.0
    integrator_max: 10.0

  # Pure Pursuit Controller parameters (lateral/steering control)
  # UPDATED: True Pure Pursuit implementation (2025-01-23)
  # Fixed: Replaced Stanley controller with geometric Pure Pursuit from Course1FinalProject
  #
  # CRITICAL FIX (2025-11-23): Reduced min_lookahead for intersection turns
  # Previous: 15m minimum caused corner-cutting at intersections
  # - At low speed (2.5 m/s), 15m lookahead points too far ahead
  # - Vehicle cuts corner → front wheel hits sidewalk → lane invasion
  # New: 6m minimum allows tighter turn tracking at intersections
  pure_pursuit:
    # Speed-adaptive lookahead gain: L_d = max(min_lookahead, kp_lookahead × speed)
    # Higher values → more preview → smoother tracking at high speeds
    # From Course1FinalProject/controller2d.py (working implementation)
    kp_lookahead: 0.8

    # Minimum lookahead distance in meters
    # REDUCED from 15m to 6m to handle sharp intersection turns
    # At intersection: speed=2.5 m/s → lookahead = max(6, 0.8×2.5) = 6m ✅
    # On straightaway: speed=8.3 m/s → lookahead = max(6, 0.8×8.3) = 6.64m ✅
    # Allows tighter path following at low speeds while maintaining stability
    min_lookahead: 6.0

    # Vehicle wheelbase in meters (distance between front and rear axles)
    # Used in bicycle kinematic model for steering calculation
    # Typical passenger car: 2.5-3.5m
    # CARLA default vehicles: ~3.0m
    wheelbase: 3.0

  # General controller parameters
  general:
    # Target cruising speed in km/h
    # Will be converted to m/s internally
    target_speed_kmh: 30.0

# Evaluation configuration
evaluation:
  # Number of evaluation episodes
  num_episodes: 20

  # Maximum steps per episode
  max_steps: 1000

  # Simulation timestep in seconds (should match CARLA config)
  fixed_delta_seconds: 0.05

  # CARLA map to use
  map_name: "Town01"

  # Waypoints file path
  waypoints_file: "config/waypoints.txt"

  # Weather preset (optional)
  weather: "ClearNoon"

  # Traffic configuration
  traffic:
    # Number of NPC vehicles
    num_vehicles: 50

    # Number of NPC pedestrians
    num_pedestrians: 0

  # Output directory for results
  output_dir: "results/baseline_evaluation"

  # Save trajectory data
  save_trajectory: true

  # Save camera images
  save_images: false

  # Metrics to collect
  metrics:
    - success_rate
    - avg_collisions_per_km
    - avg_speed_kmh
    - route_completion_time_s
    - avg_longitudinal_jerk_m_s3
    - avg_lateral_acceleration_m_s2
    - ttc_analysis

# Logging configuration
logging:
  # Console log level (DEBUG, INFO, WARNING, ERROR)
  console_level: "INFO"

  # File log level
  file_level: "DEBUG"

  # Log file path
  log_file: "logs/baseline_evaluation.log"

  # Enable debug info from controllers
  debug_controllers: false
