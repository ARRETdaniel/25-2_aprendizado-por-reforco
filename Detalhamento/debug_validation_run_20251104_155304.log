WARNING:root:Could not import GlobalRoutePlanner from agents.navigation. Ensure CARLA Python API is installed and PythonAPI/carla/agents is in PYTHONPATH.

======================================================================
TD3 TRAINING PIPELINE - AUTONOMOUS VEHICLE NAVIGATION
======================================================================

[CONFIG] Loading configurations...
[CONFIG] CARLA config: config/carla_config.yaml
[CONFIG] Agent config: config/td3_config.yaml
[CONFIG] Scenario: 0 (0=20, 1=50, 2=100 NPCs)
[CONFIG] Set CARLA_SCENARIO_INDEX=0
[CONFIG] Expected NPC count: 20

[ENVIRONMENT] Initializing CARLA environment...
WARNING:src.environment.carla_env:Failed to initialize DynamicRouteManager: GlobalRoutePlanner not available. Ensure CARLA agents package is installed.
Falling back to legacy waypoint manager
[ENVIRONMENT] State space: Dict('image': Box(-1.0, 1.0, (4, 84, 84), float32), 'vector': Box(-inf, inf, (53,), float32))
[ENVIRONMENT] Action space: Box(-1.0, 1.0, (2,), float32)

[AGENT] Initializing TD3 agent...
[AGENT] Device explicitly set to: cpu
[AGENT] Running on CPU to reserve GPU memory for CARLA simulator
[AGENT] Initializing SEPARATE NatureCNN feature extractors for actor and critic...
[AGENT] Initializing CNN weights (Kaiming for ReLU networks)...
[INIT] Initializing Actor CNN weights...
[INIT] Initializing Critic CNN weights...
[AGENT] CNN weights initialized with Kaiming normal (optimized for ReLU)
[AGENT] Actor CNN initialized on cpu (id: 139950425178368)
[AGENT] Critic CNN initialized on cpu (id: 139950425179232)
[AGENT] CNNs are SEPARATE instances: True
[AGENT] CNN architecture: 4×84×84 → Conv layers → 512 features
[AGENT] CNN training mode: ENABLED (weights will be updated during training)
TD3Agent initialized on device: cpu (manually specified)
  Actor CNN optimizer initialized with lr=0.0001
  Actor CNN mode: training (gradients enabled)
  Critic CNN optimizer initialized with lr=0.0001
  Critic CNN mode: training (gradients enabled)
  ✅ Actor and critic use SEPARATE CNN instances (recommended)
     Actor CNN id: 139950425178368
     Critic CNN id: 139950425179232
Traceback (most recent call last):
  File "/workspace/scripts/train_td3.py", line 1242, in <module>
    main()
  File "/workspace/scripts/train_td3.py", line 1223, in main
    trainer = TD3TrainingPipeline(
  File "/workspace/scripts/train_td3.py", line 204, in __init__
    self.agent = TD3Agent(
  File "/workspace/src/agents/td3_agent.py", line 236, in __init__
    self.replay_buffer = DictReplayBuffer(
  File "/workspace/src/utils/dict_replay_buffer.py", line 69, in __init__
    self.images = np.zeros((max_size, *image_shape), dtype=np.float32)
numpy.core._exceptions._ArrayMemoryError: Unable to allocate 105. GiB for an array with shape (1000000, 4, 84, 84) and data type float32
